"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[797],{43613:function(e,t,a){var r=a(57437);a(2265);var s=a(93439),n=a(60525),o=a(81315),l=a(46191);a(2446),t.Z=e=>{var t,a,i,d,c;let{response:u}=e,g="";if(console.log("\uD83D\uDD0D Debug AgentResponseRenderer - Respuesta completa:",u),null===(t=u.interaction)||void 0===t?void 0:t.formatted_content)g=u.interaction.formatted_content,console.log("✅ Usando interaction.formatted_content");else if(u.formatted_content)g=u.formatted_content,console.log("✅ Usando formatted_content");else if(null===(a=u.interaction)||void 0===a?void 0:a.agent_response)g=u.interaction.agent_response,console.log("✅ Usando interaction.agent_response");else if(u.guidance)g=u.guidance,console.log("✅ Usando guidance");else if("string"==typeof u)g=u,console.log("✅ Usando response como string");else{let e=Object.keys(u);for(let t of(console.log("\uD83D\uDD0D Campos disponibles en response:",e),e)){let e=u[t];if("string"==typeof e&&e.length>10&&!["id","timestamp","type"].includes(t)){g=e,console.log("✅ Usando campo ".concat(t," como contenido"));break}}g||(g=JSON.stringify(u,null,2),console.log("⚠️ Usando JSON completo como fallback"))}if(g){let e=g;e!==(g="string"!=typeof(c=g)?c:c.replace(/\x1b\[[0-9;]*m/g,"").replace(/\[\d{1,2}m/g,"").replace(/\[0m/g,"").replace(/┃/g,"").replace(/┗━+┛/g,"").replace(/━+/g,"").trim())&&console.log("\uD83E\uDDF9 C\xf3digos ANSI removidos:",{antes:e.substring(0,100)+"...",despues:g.substring(0,100)+"..."})}!g||!(g.length>20)||g.includes("#")||g.includes("**")||g.includes("*")||(console.log("\uD83D\uDD27 Convirtiendo texto plano a markdown"),g.split("\n").filter(e=>e.trim()).length>3?g="## \uD83D\uDCDA Respuesta\n\n".concat(g):g.length>100&&(g="## \uD83D\uDCDA Respuesta\n\n".concat(g)),g=(g=g.replace(/(\d+)\.\s+/g,"\n$1. ")).replace(/(-|\*)\s+/g,"\n- "));let m=u.agent||{},p=u.response_metadata||(null===(i=u.interaction)||void 0===i?void 0:i.response_metadata)||{};return console.log("\uD83C\uDFAF Contenido final para renderizar:",{contentLength:g.length,contentPreview:g.substring(0,200)+"...",hasMarkdown:g.includes("#")||g.includes("**")||g.includes("*"),agent:(null==m?void 0:m.name)||"Sin nombre"}),(0,r.jsxs)("div",{className:"agent-response-container bg-white rounded-lg p-6 shadow-lg border border-gray-200 mb-6",children:[(0,r.jsxs)("div",{className:"agent-header flex items-center gap-3 mb-4 pb-3 border-b border-gray-100",children:[(0,r.jsx)("span",{className:"agent-icon text-2xl",children:(null==m?void 0:m.icon)||u.agent_icon}),(0,r.jsx)("span",{className:"agent-name font-semibold text-gray-800 text-lg",children:(null==m?void 0:m.name)||u.agent_name}),((null==m?void 0:m.is_real)||u.is_real_agent)&&(0,r.jsx)("span",{className:"real-agent-badge bg-green-500 text-white text-xs px-2 py-1 rounded-full font-medium",children:"\uD83E\uDD16 Agente Real"})]}),(0,r.jsx)("div",{className:"markdown-content",children:(0,r.jsx)(s.UG,{remarkPlugins:[n.Z,o.Z],rehypePlugins:[l.Z],components:{h1:e=>{let{children:t}=e;return(0,r.jsx)("h1",{className:"text-3xl font-bold mb-6 text-blue-700 border-b-2 border-blue-200 pb-2",children:t})},h2:e=>{let{children:t}=e;return(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4 text-blue-600 mt-6",children:t})},h3:e=>{let{children:t}=e;return(0,r.jsx)("h3",{className:"text-xl font-semibold mb-3 text-blue-500 mt-4",children:t})},h4:e=>{let{children:t}=e;return(0,r.jsx)("h4",{className:"text-lg font-semibold mb-2 text-blue-400 mt-3",children:t})},p:e=>{let{children:t}=e;return(0,r.jsx)("p",{className:"mb-4 leading-relaxed text-gray-700",children:t})},blockquote:e=>{let{children:t}=e;return(0,r.jsx)("blockquote",{className:"border-l-4 border-blue-300 bg-blue-50 dark:bg-blue-900/20 pl-4 py-3 mb-4 italic rounded-r-lg shadow-sm",children:t})},code(e){let{node:t,inline:a,className:s,children:n,...o}=e||{},l=/language-(\w+)/.exec(s||""),i=l?l[1]:"";return(String(n||"").replace(/\n$/,""),a)?(0,r.jsx)("code",{className:"bg-gray-200 dark:bg-gray-700 text-red-600 dark:text-red-400 px-2 py-1 rounded text-sm font-mono",children:n}):(0,r.jsxs)("div",{className:"mb-4",children:[i&&(0,r.jsx)("div",{className:"bg-gray-700 text-white px-3 py-1 text-xs rounded-t-lg font-medium",children:i}),(0,r.jsx)("pre",{className:"bg-gray-100 dark:bg-gray-800 p-4 overflow-x-auto font-mono text-sm border ".concat(i?"rounded-b-lg border-t-0":"rounded-lg"," border-gray-200 dark:border-gray-600"),children:(0,r.jsx)("code",{...o,children:n})})]})},ul:e=>{let{children:t}=e;return(0,r.jsx)("ul",{className:"list-disc list-inside mb-4 space-y-1 text-gray-700 ml-4",children:t})},ol:e=>{let{children:t}=e;return(0,r.jsx)("ol",{className:"list-decimal list-inside mb-4 space-y-1 text-gray-700 ml-4",children:t})},li:e=>{let{children:t}=e;return(0,r.jsx)("li",{className:"mb-1 leading-relaxed",children:t})},table:e=>{let{children:t}=e;return(0,r.jsx)("div",{className:"overflow-x-auto mb-6 shadow-sm rounded-lg border border-gray-200 dark:border-gray-600",children:(0,r.jsx)("table",{className:"min-w-full border-collapse",children:t})})},thead:e=>{let{children:t}=e;return(0,r.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t})},th:e=>{let{children:t}=e;return(0,r.jsx)("th",{className:"border-b border-gray-300 dark:border-gray-600 px-4 py-3 text-left font-semibold text-gray-800 dark:text-gray-200",children:t})},td:e=>{let{children:t}=e;return(0,r.jsx)("td",{className:"border-b border-gray-200 dark:border-gray-700 px-4 py-2 text-gray-700 dark:text-gray-300",children:t})},a:e=>{let{href:t,children:a}=e;return(0,r.jsx)("a",{href:t,className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 underline transition-colors duration-200",target:"_blank",rel:"noopener noreferrer",children:a})},strong:e=>{let{children:t}=e;return(0,r.jsx)("strong",{className:"font-bold text-gray-900 dark:text-gray-100",children:t})},em:e=>{let{children:t}=e;return(0,r.jsx)("em",{className:"italic text-gray-800 dark:text-gray-200",children:t})},hr:()=>(0,r.jsx)("hr",{className:"my-6 border-t-2 border-gray-200 dark:border-gray-600"})},children:g||"## ⚠️ Contenido Vac\xedo\n\nNo se recibi\xf3 respuesta del agente. Por favor, intenta nuevamente."})}),(0,r.jsx)("div",{className:"response-metadata",children:(0,r.jsxs)("div",{className:"text-sm text-gray-500 flex flex-wrap gap-4 pt-3 border-t border-gray-200",children:[(0,r.jsxs)("span",{children:["\uD83D\uDCCF ",p.length||(null==g?void 0:g.length)||0," caracteres"]}),(0,r.jsxs)("span",{children:["\uD83D\uDD52 ",u.timestamp?new Date(u.timestamp).toLocaleTimeString():new Date().toLocaleTimeString()]}),p.model_used&&(0,r.jsxs)("span",{children:["\uD83E\uDD16 ",p.model_used]}),(p.has_markdown||(null===(d=u.interaction)||void 0===d?void 0:d.contains_markdown))&&(0,r.jsx)("span",{children:"\uD83D\uDCDD Contiene Markdown"})]})})]})}},25669:function(e,t,a){a.d(t,{Z:function(){return l}});var r=a(57437),s=a(2265),n=a(43613);let o=()=>{let[e,t]=(0,s.useState)([]),[a,r]=(0,s.useState)(!1),[n,o]=(0,s.useState)(null);return{responses:e,loading:a,error:n,sendMessage:(0,s.useCallback)(async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"tutor";if(!e.trim())throw Error("El mensaje no puede estar vac\xedo");r(!0),o(null);try{let r=await fetch("/api/agents/chat/formatted",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,agent_id:a,context:{}})});if(!r.ok)throw Error("Error ".concat(r.status,": ").concat(r.statusText));let o=await r.json();if(console.log("✅ Respuesta recibida del backend:",o),console.log("� Estructura de la respuesta:",{hasInteraction:!!o.interaction,hasFormattedContent:!!o.formatted_content,hasAgent:!!o.agent,interactionKeys:o.interaction?Object.keys(o.interaction):[],topLevelKeys:Object.keys(o)}),o.interaction){var s,n;console.log("� Contenido en interaction:",{hasFormattedContent:!!o.interaction.formatted_content,hasAgentResponse:!!o.interaction.agent_response,hasRealNewlines:o.interaction.has_real_newlines,containsMarkdown:o.interaction.contains_markdown,formattedContentPreview:null===(s=o.interaction.formatted_content)||void 0===s?void 0:s.substring(0,100),agentResponsePreview:null===(n=o.interaction.agent_response)||void 0===n?void 0:n.substring(0,100)})}return o.timestamp||(o.timestamp=new Date().toISOString()),t(e=>[...e,o]),o}catch(e){throw console.error("Error enviando mensaje:",e),o(e instanceof Error?e.message:"Error desconocido"),e}finally{r(!1)}},[]),clearResponses:(0,s.useCallback)(()=>{t([]),o(null)},[])}};var l=()=>{let[e,t]=(0,s.useState)(""),{responses:a,loading:l,error:i,sendMessage:d,clearResponses:c}=o(),u=async()=>{if(e.trim())try{await d(e),t("")}catch(e){console.error("Error en handleSend:",e)}};return(0,r.jsxs)("div",{className:"chat-container max-w-4xl mx-auto p-6",children:[(0,r.jsxs)("div",{className:"chat-header mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"\uD83E\uDD16 Tutor IA - Sistema Educativo"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Pregunta cualquier duda acad\xe9mica y recibe respuestas detalladas y formateadas."})]}),i&&(0,r.jsxs)("div",{className:"error-message bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:["❌ Error: ",i]}),(0,r.jsxs)("div",{className:"input-section mb-6",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("textarea",{value:e,onChange:e=>t(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),u())},placeholder:"Pregunta algo al tutor... (Ej: \xbfQu\xe9 es una derivada?)",className:"flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:3,disabled:l}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("button",{onClick:u,disabled:l||!e.trim(),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?"⏳ Enviando...":"\uD83D\uDCE4 Enviar"}),a.length>0&&(0,r.jsx)("button",{onClick:c,disabled:l,className:"px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 disabled:opacity-50 text-sm",children:"\uD83D\uDDD1️ Limpiar"})]})]}),(0,r.jsx)("div",{className:"text-sm text-gray-500 mt-2",children:"\uD83D\uDCA1 Tip: Usa Enter para enviar, Shift+Enter para nueva l\xednea"})]}),(0,r.jsxs)("div",{className:"responses-section",children:[0===a.length&&!l&&(0,r.jsxs)("div",{className:"empty-state text-center py-12 text-gray-500",children:[(0,r.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCAC"}),(0,r.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"\xa1Haz tu primera pregunta!"}),(0,r.jsx)("p",{children:"El tutor IA est\xe1 listo para ayudarte con cualquier tema acad\xe9mico."})]}),a.map((e,t)=>(0,r.jsx)(n.Z,{response:e},t)),l&&(0,r.jsxs)("div",{className:"loading-message bg-blue-50 border border-blue-200 p-4 rounded-lg flex items-center gap-3",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,r.jsx)("span",{className:"text-blue-700",children:"El tutor est\xe1 preparando tu respuesta..."})]})]})]})}},8102:function(e,t,a){var r=a(57437),s=a(2265),n=a(43613);t.Z=()=>{let[e,t]=(0,s.useState)(""),[a,o]=(0,s.useState)([]),[l,i]=(0,s.useState)(!1),[d,c]=(0,s.useState)(null),u=async()=>{if(e.trim()){i(!0),c(null);try{let a=await fetch("/api/agents/unified-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,context:{}})});if(!a.ok)throw Error("Error ".concat(a.status,": ").concat(a.statusText));let r=await a.json();console.log("✅ Respuesta multi-agente recibida:",r),o(e=>[...e,r]),t("")}catch(e){console.error("Error enviando mensaje multi-agente:",e),c(e instanceof Error?e.message:"Error desconocido")}finally{i(!1)}}};return(0,r.jsxs)("div",{className:"multi-agent-chat max-w-6xl mx-auto p-6",children:[(0,r.jsxs)("div",{className:"chat-header mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"\uD83C\uDFAF Chat Multi-Agente - Sistema Educativo"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Pregunta algo y recibe respuestas de m\xfaltiples agentes especializados."})]}),d&&(0,r.jsxs)("div",{className:"error-message bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:["❌ Error: ",d]}),(0,r.jsxs)("div",{className:"input-section mb-6",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("textarea",{value:e,onChange:e=>t(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),u())},placeholder:"Pregunta algo a todos los agentes... (Ej: \xbfC\xf3mo puedo mejorar en matem\xe1ticas?)",className:"flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:3,disabled:l}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("button",{onClick:u,disabled:l||!e.trim(),className:"px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?"⏳ Consultando...":"\uD83D\uDE80 Consultar Todos"}),a.length>0&&(0,r.jsx)("button",{onClick:()=>{o([]),c(null)},disabled:l,className:"px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 disabled:opacity-50 text-sm",children:"\uD83D\uDDD1️ Limpiar"})]})]}),(0,r.jsx)("div",{className:"text-sm text-gray-500 mt-2",children:"\uD83D\uDCA1 Tip: Esta consulta llegar\xe1 a todos los agentes especializados"})]}),(0,r.jsxs)("div",{className:"responses-section",children:[0===a.length&&!l&&(0,r.jsxs)("div",{className:"empty-state text-center py-12 text-gray-500",children:[(0,r.jsx)("div",{className:"text-6xl mb-4",children:"\uD83C\uDFAF"}),(0,r.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"\xa1Consulta a todos los agentes!"}),(0,r.jsx)("p",{children:"Haz una pregunta y recibe perspectivas de m\xfaltiples agentes especializados."})]}),a.map((t,a)=>{var s,o;return(0,r.jsxs)("div",{className:"response-group mb-8",children:[(0,r.jsx)("div",{className:"group-header bg-gradient-to-r from-purple-500 to-blue-500 text-white p-4 rounded-t-lg",children:(0,r.jsxs)("h3",{className:"text-lg font-semibold",children:["\uD83D\uDCCA Respuestas de ",(null===(s=t.responses)||void 0===s?void 0:s.length)||0," Agentes"]})}),(0,r.jsx)("div",{className:"agent-responses grid gap-4 mt-4",children:null===(o=t.responses)||void 0===o?void 0:o.map((t,a)=>{var s;let o={success:!0,agent:{id:t.agent_type,name:t.agent_name,icon:t.agent_icon,is_real:t.is_real_agent,status:t.is_real_agent?"\uD83E\uDD16 Agente Real":"\uD83C\uDFAD Simulado"},interaction:{user_message:e,agent_response:t.response,formatted_content:t.formatted_content,contains_markdown:(null===(s=t.response_metadata)||void 0===s?void 0:s.has_markdown)||!1},response_metadata:t.response_metadata,timestamp:new Date().toISOString()};return(0,r.jsx)(n.Z,{response:o},a)})})]},a)}),l&&(0,r.jsxs)("div",{className:"loading-message bg-purple-50 border border-purple-200 p-6 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-purple-600"}),(0,r.jsx)("span",{className:"text-purple-700 font-semibold",children:"Consultando a todos los agentes..."})]}),(0,r.jsx)("div",{className:"text-sm text-purple-600",children:"Esto puede tomar unos momentos mientras cada agente especializado prepara su respuesta."})]})]})]})}},3711:function(e,t,a){a.d(t,{G:function(){return n}});var r=a(74780);class s{async sendMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"tutor",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{var r;let s=await fetch("".concat(this.baseUrl,"/api/agents/chat/formatted"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,agent_id:t,context:a})});if(!s.ok)throw Error("Error ".concat(s.status,": ").concat(s.statusText));let n=await s.json();return n.timestamp||(n.timestamp=new Date().toISOString()),console.log("✅ Respuesta del agente recibida:",n),console.log("\uD83D\uDCDD Contiene markdown:",null===(r=n.interaction)||void 0===r?void 0:r.contains_markdown),n}catch(e){throw console.error("Error en sendMessage:",e),e}}async sendMultiAgentMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var a;let r=await fetch("".concat(this.baseUrl,"/api/agents/unified-chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,context:t})});if(!r.ok)throw Error("Error ".concat(r.status,": ").concat(r.statusText));let s=await r.json();return console.log("✅ Respuesta multi-agente recibida:",s),console.log("\uD83E\uDD16 N\xfamero de agentes que respondieron:",(null===(a=s.responses)||void 0===a?void 0:a.length)||0),s}catch(e){throw console.error("Error en sendMultiAgentMessage:",e),e}}async getCoachGuidance(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var a;let r=await fetch("".concat(this.baseUrl,"/api/agents/student-coach"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,context:t})});if(!r.ok)throw Error("Error ".concat(r.status,": ").concat(r.statusText));let s=await r.json();return console.log("✅ Orientaci\xf3n del coach recibida:",s),console.log("\uD83D\uDCDD Contiene markdown:",null===(a=s.response_metadata)||void 0===a?void 0:a.has_markdown),s}catch(e){throw console.error("Error en getCoachGuidance:",e),e}}async testCleanResponse(){try{let e=await fetch("".concat(this.baseUrl,"/api/agents/test-clean-response"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error ".concat(e.status,": ").concat(e.statusText));let t=await e.json();return console.log("✅ Test de limpieza:",t),t}catch(e){throw console.error("Error en testCleanResponse:",e),e}}async renderMarkdown(e){try{let t=await fetch("".concat(this.baseUrl,"/api/agents/render-markdown"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})});if(!t.ok)throw Error("Error ".concat(t.status,": ").concat(t.statusText));return(await t.json()).rendered_html||e}catch(e){throw console.error("Error en renderMarkdown:",e),e}}async getAgentsInfo(){try{let e=await fetch("".concat(this.baseUrl,"/api/agents/info"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Error ".concat(e.status,": ").concat(e.statusText));let t=await e.json();return console.log("✅ Informaci\xf3n de agentes:",t),t.agents||[]}catch(e){throw console.error("Error en getAgentsInfo:",e),e}}constructor(e=""){this.baseUrl=e}}let n=new s((0,r.X)())}}]);